
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as E,ak as k,av as N,c as w,Q as _,i as c,o,Z as m,b as C,a as h,a3 as p,u as g,aw as $,T as W,m as F,ax as J,w as b,z as O,ar as P,k as A,$ as q,C as L,ai as H,aa as V}from"./index-CdccOLXW.js";import{I as j,r as z}from"./item-5H3rmTyU.js";const D={class:"columns-3 p-2 px-3 2xl:columns-4"},G=E({name:"SubMenu",__name:"sub",props:{uniqueKey:{},menu:{},level:{default:0}},setup(R){const s=R,f=s.menu.path??JSON.stringify(s.menu),y=k("itemRef"),v=k("subMenuRef"),t=N(z),B=w(()=>t.openedMenus.includes(s.uniqueKey.at(-1))),x={enter(e){e.offsetHeight>window.innerHeight&&(e.style.height=`${window.innerHeight}px`)},afterEnter:()=>{},beforeLeave:e=>{e.style.overflow="hidden",e.style.maxHeight=`${e.offsetHeight}px`},leave:e=>{e.style.maxHeight="0"},afterLeave(e){e.style.overflow="",e.style.maxHeight=""}},S={enterActiveClass:"ease-in-out duration-300",enterFromClass:"opacity-0 translate-x-4",enterToClass:"opacity-100",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},d=w(()=>{let e=!0;return s.menu.children?s.menu.children.every(l=>{var i;return((i=l.meta)==null?void 0:i.menu)===!1})&&(e=!1):e=!1,e});function K(){d.value||t.handleMenuItemClick(f)}let u;function I(){s.level===0&&(t.mouseInMenu=s.uniqueKey,u==null||u(),{stop:u}=H(()=>{if(d.value)t.openMenu(f),V(()=>{var n,a;const e=(n=y.value)==null?void 0:n.ref,l=(a=v.value)==null?void 0:a.$el;if(!e||!l)return;let i=0,r=0;t.props.mode==="vertical"||s.level!==0?(i=e.getBoundingClientRect().top+e.scrollTop,r=(t.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right)+e.getBoundingClientRect().width,i+l.offsetHeight>window.innerHeight&&(i=window.innerHeight-l.offsetHeight)):(i=e.getBoundingClientRect().top+e.getBoundingClientRect().height,r=t.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right,i+l.offsetHeight>window.innerHeight&&(l.style.height=`${window.innerHeight-i}px`),r+l.offsetWidth>document.documentElement.clientWidth&&(r=document.documentElement.clientWidth-l.offsetWidth)),l.style.top=`${i}px`,l.style.insetInlineStart=`${r}px`});else{const e=s.menu.children?t.subMenus[f].indexPath.at(-1):t.items[f].indexPath.at(-1);t.openMenu(e)}},300))}function M(){s.level===0&&(t.mouseInMenu=[],u==null||u(),{stop:u}=H(()=>{t.mouseInMenu.length===0?t.closeMenu(s.uniqueKey):d.value&&!t.mouseInMenu.includes(s.uniqueKey.at(-1))&&t.closeMenu(s.uniqueKey.at(-1))},300))}function T(){u==null||u()}return(e,l)=>{const i=_("SubMenu"),r=P;return o(),c(m,null,[C(j,{ref_key:"itemRef",ref:y,"unique-key":e.uniqueKey,item:e.menu,level:e.level,"sub-menu":g(d),onClick:K,onMouseenter:I,onMouseleave:M},null,8,["unique-key","item","level","sub-menu"]),g(d)?(o(),h($,{key:0,to:"body",disabled:e.level!==0},[e.level===0?(o(),h(W,F({key:0},S,J(x)),{default:b(()=>[O(C(r,{ref_key:"subMenuRef",ref:v,mask:"",class:"sub-menu z-3000 w-150 border rounded-lg bg-[var(--g-sub-sidebar-bg)] shadow-xl fixed! 2xl:w-200",onMouseenter:T,onMouseleave:M},{default:b(()=>[A("div",D,[(o(!0),c(m,null,q(e.menu.children,n=>{var a;return o(),c("div",{key:n.path??JSON.stringify(n),class:"w-full break-inside-avoid"},[((a=n.meta)==null?void 0:a.menu)!==!1?(o(),h(i,{key:0,"unique-key":[...e.uniqueKey,n.path??JSON.stringify(n)],menu:n,level:e.level+1},null,8,["unique-key","menu","level"])):p("",!0)])}),128))])]),_:1},512),[[L,g(B)]])]),_:1},16)):(o(!0),c(m,{key:1},q(e.menu.children,n=>{var a;return o(),c(m,{key:n.path??JSON.stringify(n)},[((a=n.meta)==null?void 0:a.menu)!==!1?(o(),h(i,{key:0,"unique-key":[...e.uniqueKey,n.path??JSON.stringify(n)],menu:n,level:e.level+1},null,8,["unique-key","menu","level"])):p("",!0)],64)}),128))],8,["disabled"])):p("",!0)],64)}}});export{G as _};
//# sourceMappingURL=sub.vue_vue_type_script_setup_true_lang-CEAG9GJF.js.map
