
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as re,g as ue,l as ie,a1 as ce,a2 as de,bs as fe,ac as pe,aq as he,p as D,aj as F,bt as me,c as ve,Y as J,a8 as _e,ad as v,ae as be,bu as Y,a as I,o as p,w as b,k as r,i as y,u as l,Z,$ as G,O as Q,a3 as M,P as ge,A as x,K as W,b as h,z as ye,bv as C,bo as T,B as xe,bq as ke,as as we}from"./index-BZo-B8MS.js";import{_ as Re}from"./index.vue_vue_type_script_setup_true_lang-YKY9xtQH.js";import Se from"./index-Iu2vPdaI.js";import{_ as ze}from"./item.vue_vue_type_script_setup_true_lang-DB2RMTvK.js";import{m as X}from"./index-RKlUGH8s.js";const Ie={class:"h-12 flex flex-shrink-0 items-center"},Me={class:"h-full w-14 flex-center"},Ce=["placeholder","onKeydown"],Te={key:0,class:"h-full w-14 flex-center border-s"},Ve={class:"w-full flex justify-between px-4 py-3"},Be={class:"flex gap-8"},Ee={class:"inline-flex items-center gap-1 text-xs"},$e={class:"inline-flex items-center gap-1 text-xs"},Le={key:0,class:"inline-flex items-center gap-1 text-xs"},Ne=["data-index","onClick","onMouseover"],He={class:"flex flex-1 flex-col gap-1 truncate border-s px-4 py-3"},Ue={class:"truncate text-start text-base font-bold"},qe={key:1,class:"h-full flex-col-center py-6 text-secondary-foreground/50"},De={class:"m-2 text-base"},Fe={key:2,class:"h-full flex-col-center py-6 text-secondary-foreground/50"},Ke={class:"m-2 text-base"},Pe=re({name:"Search",__name:"search",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(V){const c=ue(V,"modelValue"),{t:k}=ie(),te=ce(),R=de(),B=fe(),se=pe(),{generateI18nTitle:w}=he(),f=D(""),K=F("searchInputRef"),{focused:ne}=me(K),E=D([]),o=D(-1),$=F("searchResultRef"),S=F("searchResultItemRef"),g=ve(()=>{let a=[];return a=E.value.filter(e=>{var n;let t=!1;return f.value!==""&&(e.path.includes(f.value)&&(t=!0),(w(e.title).toString().includes(f.value)||(((n=X(w(e.title).toString(),f.value,{continuous:!0}))==null?void 0:n.length)??0)>0)&&(t=!0),B.getRouteMatchedByPath(e.path).some(i=>{var s,u,d;return w((s=i.meta)==null?void 0:s.title).toString().includes(f.value)||(((d=X(w((u=i.meta)==null?void 0:u.title).toString(),f.value,{continuous:!0}))==null?void 0:d.length)??0)>0})&&(t=!0)),t}),a});J(()=>c.value,a=>{a?(f.value="",o.value=-1,v("up",L),v("down",N),v("enter",H),v("esc",e=>{R.settings.navSearch.enableHotkeys&&(e.preventDefault(),c.value=!1)})):(v.unbind("up",L),v.unbind("down",N),v.unbind("enter",H),v.unbind("esc"))}),J(()=>g.value,()=>{o.value=-1,U()}),_e(()=>{ae(),v("command+k, ctrl+k",a=>{R.settings.navSearch.enableHotkeys&&(a.preventDefault(),c.value=!0)})}),be(()=>{v.unbind("command+k, ctrl+k")});function ae(){E.value=[],se.allMenus.forEach(a=>{P(a.children)})}function le(a){var t;let e=!0;return(t=a.children)!=null&&t.every(n=>{var i;return((i=n.meta)==null?void 0:i.menu)===!1})&&(e=!1),e}function P(a,e,t){a.forEach(n=>{var i,s,u,d,_,m;((i=n.meta)==null?void 0:i.menu)!==!1&&(n.children&&le(n)?P(n.children,Y(e,n.path),((s=n.meta)==null?void 0:s.icon)??t):E.value.push({path:Y(e,n.path),query:(u=n.meta)==null?void 0:u.query,icon:((d=n.meta)==null?void 0:d.icon)??t,title:(_=n.meta)==null?void 0:_.title,link:(m=n.meta)==null?void 0:m.link}))})}function L(){g.value.length&&(o.value-=1,o.value<0&&(o.value=g.value.length-1),U())}function N(){g.value.length&&(o.value+=1,o.value>g.value.length-1&&(o.value=0),U())}function H(){var a,e;o.value!==-1&&((e=(a=S.value)==null?void 0:a.find(t=>Number.parseInt(t.dataset.index)===o.value))==null||e.click())}function U(){var a,e,t,n,i,s,u,d;if((n=(t=(e=(a=$.value)==null?void 0:a.areaRef)==null?void 0:e.ref)==null?void 0:t.el)!=null&&n.viewportElement){const _=$.value.areaRef.ref.el.viewportElement;let m=0;if(o.value!==-1){m=_.scrollTop;const z=((s=(i=S.value)==null?void 0:i.find(q=>Number.parseInt(q.dataset.index)===o.value))==null?void 0:s.offsetTop)??0,O=((d=(u=S.value)==null?void 0:u.find(q=>Number.parseInt(q.dataset.index)===o.value))==null?void 0:d.clientHeight)??0,j=_.scrollTop,A=_.clientHeight;z+O>j+A?m=z+O-A:z<=j&&(m=z-16)}_.scrollTo({top:m})}}function oe(a,e,t){t?window.open(t,"_blank"):te.push({path:a,query:e}),c.value=!1}return(a,e)=>{const t=ge,n=Re,i=we;return p(),I(i,{ref_key:"searchResultRef",ref:$,modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=s=>c.value=s),border:"",footer:l(R).mode==="pc",closable:!1,class:"w-full lg-max-w-2xl","content-class":"flex flex-col p-0 min-h-auto","header-class":"p-0","footer-class":"p-0",onOpened:e[4]||(e[4]=s=>ne.value=!0)},{header:b(()=>[r("div",Ie,[r("div",Me,[h(t,{name:"i-ri:search-line",class:"size-4 text-foreground/30"})]),ye(r("input",{ref_key:"searchInputRef",ref:K,"onUpdate:modelValue":e[0]||(e[0]=s=>xe(f)?f.value=s:null),placeholder:l(k)("input"),class:"h-full w-full border-0 rounded-md bg-transparent text-base text-foreground focus-outline-none placeholder-foreground/30",onKeydown:[e[1]||(e[1]=C(T(s=>c.value=!1,["prevent"]),["esc"])),C(T(L,["prevent"]),["up"]),C(T(N,["prevent"]),["down"]),C(T(H,["prevent"]),["enter"])]},null,40,Ce),[[ke,l(f)]]),l(R).mode==="mobile"?(p(),y("div",Te,[h(t,{name:"i-carbon:close",class:"size-4",onClick:e[2]||(e[2]=s=>c.value=!1)})])):M("",!0)])]),footer:b(()=>[r("div",Ve,[r("div",Be,[r("div",Ee,[h(n,null,{default:b(()=>[h(t,{name:"i-ion:md-return-left",class:"size-4"})]),_:1}),r("span",null,x(l(k)("enter")),1)]),r("div",$e,[h(n,null,{default:b(()=>[h(t,{name:"i-ant-design:caret-up-filled",class:"size-4"})]),_:1}),h(n,null,{default:b(()=>[h(t,{name:"i-ant-design:caret-down-filled",class:"size-4"})]),_:1}),r("span",null,x(l(k)("up_down")),1)])]),l(R).settings.navSearch.enableHotkeys?(p(),y("div",Le,[h(n,null,{default:b(()=>e[5]||(e[5]=[W(" ESC ")])),_:1}),r("span",null,x(l(k)("esc")),1)])):M("",!0)])]),default:b(()=>[r("div",null,[l(g).length>0?(p(!0),y(Z,{key:0},G(l(g),(s,u)=>(p(),y("div",{ref_for:!0,ref_key:"searchResultItemRef",ref:S,key:s.path,class:"p-4","data-index":u,onClick:d=>oe(s.path,s.query,s.link),onMouseover:d=>o.value=u},[r("a",{class:Q(["flex cursor-pointer items-center border rounded-lg",{"-mt-4":u!==0,"bg-accent":u===l(o)}])},[s.icon?(p(),I(t,{key:0,name:s.icon,class:Q(["size-5 basis-16 transition",{"scale-120 text-primary":u===l(o)}])},null,8,["name","class"])):M("",!0),r("div",He,[r("div",Ue,x(l(w)(s.title)),1),l(B).getRouteMatchedByPath(s.path).length?(p(),I(Se,{key:0,class:"truncate"},{default:b(()=>[(p(!0),y(Z,null,G(l(B).getRouteMatchedByPath(s.path),(d,_)=>(p(),I(ze,{key:_,class:"text-xs"},{default:b(()=>{var m;return[W(x(l(w)((m=d.meta)==null?void 0:m.title)),1)]}),_:2},1024))),128))]),_:2},1024)):M("",!0)])],2)],40,Ne))),128)):l(f)===""?(p(),y("div",qe,[h(t,{name:"i-tabler:mood-smile",class:"size-10"}),r("p",De,x(l(k)("welcome")),1)])):(p(),y("div",Fe,[h(t,{name:"i-tabler:mood-empty",class:"size-10"}),r("p",Ke,x(l(k)("empty")),1)]))])]),_:1},8,["modelValue","footer"])}}});function ee(V){const c=V;c.__i18n=c.__i18n||[],c.__i18n.push({locale:"",resource:{"zh-cn":{input:{t:0,b:{t:2,i:[{t:3}],s:"支持标题、拼音(首字母)、URL模糊查询"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"输入你要搜索的导航"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"没有找到你想要的"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"切换"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"访问"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"退出"}}},"zh-tw":{input:{t:0,b:{t:2,i:[{t:3}],s:"支持標題、拼音(首字母)、URL模糊查詢"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"輸入你要搜索的導航"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"沒有找到你想要的"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"切換"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"訪問"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"退出"}}},en:{input:{t:0,b:{t:2,i:[{t:3}],s:"Support title, URL fuzzy query"}},welcome:{t:0,b:{t:2,i:[{t:3}],s:"Enter the navigation you want to search"}},empty:{t:0,b:{t:2,i:[{t:3}],s:"Not found"}},up_down:{t:0,b:{t:2,i:[{t:3}],s:"Choice"}},enter:{t:0,b:{t:2,i:[{t:3}],s:"Enter"}},esc:{t:0,b:{t:2,i:[{t:3}],s:"Exit"}}}}})}typeof ee=="function"&&ee(Pe);export{Pe as default};
//# sourceMappingURL=search-DXlYxfi2.js.map
