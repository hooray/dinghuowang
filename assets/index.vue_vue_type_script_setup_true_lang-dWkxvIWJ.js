
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{r as J,I as b}from"./item-B1RA_Dc_.js";import{_ as q}from"./sub.vue_vue_type_script_setup_true_lang-BtpkVBO4.js";import{d as z,p as i,c as A,Y as M,at as $,au as j,i as h,o as f,O as F,u as K,Z as O,$ as L,aa as T,a3 as Y,a as B}from"./index-BZo-B8MS.js";const H=z({name:"MainMenu",__name:"index",props:{menu:{},value:{},accordion:{type:Boolean,default:!0},defaultOpeneds:{default:()=>[]},alwaysOpeneds:{default:()=>[]},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1},rounded:{type:Boolean},direction:{default:"ltr"}},setup(N){const l=N,t=i(l.value),o=i({}),c=i({}),s=i(Array.from(new Set([...l.alwaysOpeneds.slice(0),...l.defaultOpeneds.slice(0)]))),w=i(l.alwaysOpeneds.slice(0)),x=i([]),y=A(()=>l.mode==="horizontal"||l.mode==="vertical"&&l.collapse);function _(e,n=[]){e.forEach(a=>{const u=a.path??JSON.stringify(a);if(a.children){const d=[...n,u];c.value[u]={index:u,indexPath:d,active:!1},_(a.children,d)}else o.value[u]={index:u,indexPath:n}})}const m=(e,n)=>{s.value.includes(e)||(l.accordion&&(s.value=s.value.filter(a=>n.includes(a)||w.value.includes(a))),s.value.push(e))},v=e=>{if(Array.isArray(e)){T(()=>{v(e.at(-1)),e.length>1&&v(e.slice(0,-1))});return}s.value=s.value.filter(n=>n!==e)};function g(e){var n,a;for(const u in c.value)c.value[u].active=!1;(n=c.value[e])==null||n.indexPath.forEach(u=>{c.value[u].active=!0}),(a=o.value[e])==null||a.indexPath.forEach(u=>{c.value[u].active=!0})}const C=e=>{(l.mode==="horizontal"||l.collapse)&&(s.value=[]),g(e)},P=(e,n)=>{s.value.includes(e)?v(e):m(e,n)};function k(){const e=t.value&&o.value[t.value];g(t.value),!(!e||y.value||l.collapse)&&e.indexPath.forEach(n=>{const a=c.value[n];a&&m(n,a.indexPath)})}return M(()=>l.menu,e=>{_(e),k()},{deep:!0,immediate:!0}),M(()=>l.value,e=>{o.value[e]||(t.value="");const n=o.value[e]||t.value&&o.value[t.value]||o.value[l.value];n?t.value=n.index:t.value=e,k()}),M(()=>l.collapse,e=>{e?s.value=[]:s.value=l.alwaysOpeneds.slice(0),k()}),$(J,j({props:l,items:o,subMenus:c,activeIndex:t,openedMenus:s,alwaysOpenedsMenus:w,mouseInMenu:x,isMenuPopup:y,openMenu:m,closeMenu:v,handleMenuItemClick:C,handleSubMenuClick:P})),(e,n)=>(f(),h("div",{class:F(["h-full w-full flex flex-col of-hidden transition-all-300",{"flex-row! w-auto!":K(y)&&l.mode==="horizontal","py-1":l.mode==="vertical"}])},[(f(!0),h(O,null,L(e.menu,a=>{var u,d,I;return f(),h(O,{key:a.path??JSON.stringify(a)},[((u=a.meta)==null?void 0:u.menu)!==!1?(f(),h(O,{key:0},[(d=a.children)!=null&&d.length?(f(),B(q,{key:0,menu:a,"unique-key":[a.path??(a.children.every(p=>{var r;return((r=p.meta)==null?void 0:r.menu)===!1})?a.children[0].path:JSON.stringify(a))]},null,8,["menu","unique-key"])):(f(),B(b,{key:1,item:a,"unique-key":[a.path??((I=a.children)!=null&&I.every(p=>{var r;return((r=p.meta)==null?void 0:r.menu)===!1})?a.children[0].path:JSON.stringify(a))],onClick:p=>{var r;return C(a.path??((r=a.children)!=null&&r.every(E=>{var S;return((S=E.meta)==null?void 0:S.menu)===!1})?a.children[0].path:JSON.stringify(a)))}},null,8,["item","unique-key","onClick"]))],64)):Y("",!0)],64)}),128))],2))}});export{H as _};
//# sourceMappingURL=index.vue_vue_type_script_setup_true_lang-dWkxvIWJ.js.map
