
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as _,aj as b,av as S,c as p,Q as $,i as m,o as d,Z as h,b as x,a as g,a3 as y,u as i,aw as E,w as H,ar as I,O as F,$ as A,m as O,ax as L,T as N,ah as k,aa as W}from"./index-DZhCbklB.js";import{I as j,r as J}from"./item-C33Re4Ms.js";const Q=_({name:"SubMenu",__name:"sub",props:{uniqueKey:{},menu:{},level:{default:0}},setup(R){const n=R,c=n.menu.path??JSON.stringify(n.menu),v=b("itemRef"),M=b("subMenuRef"),t=S(J),C=p(()=>t.openedMenus.includes(n.uniqueKey.at(-1))),w=p(()=>t.alwaysOpenedsMenus.includes(n.uniqueKey.at(-1))),q=p(()=>t.isMenuPopup?{enter(e){e.offsetHeight>window.innerHeight&&(e.style.height=`${window.innerHeight}px`)},afterEnter:()=>{},beforeLeave:e=>{e.style.maxHeight=`${e.offsetHeight}px`,e.style.overflow="hidden"},leave:e=>{e.style.maxHeight="0"},afterLeave(e){e.style.maxHeight="",e.style.overflow=""}}:{enter(e){requestAnimationFrame(()=>{e.dataset.height=e.offsetHeight.toString(),e.style.maxHeight="0",e.offsetHeight,e.style.maxHeight=`${e.dataset.height}px`,e.style.overflow="hidden"})},afterEnter(e){e.style.maxHeight="",e.style.overflow=""},enterCancelled(e){e.style.maxHeight="",e.style.overflow=""},beforeLeave(e){e.style.maxHeight=`${e.offsetHeight}px`,e.style.overflow="hidden"},leave(e){e.style.maxHeight="0"},afterLeave(e){e.style.maxHeight="",e.style.overflow=""},leaveCancelled(e){e.style.maxHeight="",e.style.overflow=""}}),B=p(()=>t.isMenuPopup?{enterActiveClass:"ease-in-out duration-300",enterFromClass:"opacity-0 translate-x-4",enterToClass:"opacity-100",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"}:{enterActiveClass:"ease-in-out duration-300",enterFromClass:"opacity-0 translate-y-4 scale-95 blur-4",enterToClass:"opacity-100 translate-y-0 scale-100 blur-0",leaveActiveClass:"ease-in-out duration-300",leaveFromClass:"opacity-100 translate-y-0 scale-100 blur-0",leaveToClass:"opacity-0 translate-y-4 scale-95 blur-4"}),r=p(()=>{let e=!0;return n.menu.children?n.menu.children.every(a=>{var s;return((s=a.meta)==null?void 0:s.menu)===!1})&&(e=!1):e=!1,e});function P(){w.value||t.isMenuPopup&&r.value||(r.value?t.handleSubMenuClick(c,n.uniqueKey):t.handleMenuItemClick(c))}let l;function K(){t.isMenuPopup&&(t.mouseInMenu=n.uniqueKey,l==null||l(),{stop:l}=k(()=>{if(r.value)t.openMenu(c,n.uniqueKey),W(()=>{var o,f;const e=(o=v.value)==null?void 0:o.ref,a=(f=M.value)==null?void 0:f.$el;if(!e||!a)return;let s=0,u=0;t.props.mode==="vertical"||n.level!==0?(s=e.getBoundingClientRect().top+e.scrollTop,s-=5,u=(t.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right)+e.getBoundingClientRect().width,u+=4,s+a.offsetHeight>window.innerHeight&&(s=window.innerHeight-a.offsetHeight)):(s=e.getBoundingClientRect().top+e.getBoundingClientRect().height,s+=3,u=t.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right,u-=5,s+a.offsetHeight>window.innerHeight&&(a.style.height=`${window.innerHeight-s}px`)),u+a.offsetWidth>document.documentElement.clientWidth&&(u=(t.props.direction==="ltr"?e.getBoundingClientRect().left:document.documentElement.clientWidth-e.getBoundingClientRect().right)-e.getBoundingClientRect().width),a.style.top=`${s}px`,a.style.insetInlineStart=`${u}px`});else{const e=n.menu.children?t.subMenus[c].indexPath.at(-1):t.items[c].indexPath.at(-1);t.openMenu(e,t.subMenus[e].indexPath)}},300))}function T(){t.isMenuPopup&&(t.mouseInMenu=[],l==null||l(),{stop:l}=k(()=>{t.mouseInMenu.length===0?t.closeMenu(n.uniqueKey):r.value&&!t.mouseInMenu.includes(n.uniqueKey.at(-1))&&t.closeMenu(n.uniqueKey.at(-1))},300))}return(e,a)=>{const s=$("SubMenu"),u=I;return d(),m(h,null,[x(j,{ref_key:"itemRef",ref:v,"unique-key":e.uniqueKey,item:e.menu,level:e.level,"sub-menu":i(r),expand:i(C),"always-expand":i(w),onClick:P,onMouseenter:K,onMouseleave:T},null,8,["unique-key","item","level","sub-menu","expand","always-expand"]),i(r)?(d(),g(E,{key:0,to:"body",disabled:!i(t).isMenuPopup},[x(N,O(i(B),L(i(q))),{default:H(()=>[i(C)?(d(),g(u,{key:0,ref_key:"subMenuRef",ref:M,scrollbar:!1,mask:i(t).isMenuPopup,class:F(["sub-menu static rounded-lg",{"bg-[var(--g-sub-sidebar-bg)]":i(t).isMenuPopup,"border shadow-xl fixed! z-3000 w-[200px]":i(t).isMenuPopup,"py-1":i(t).isMenuPopup}])},{default:H(()=>[(d(!0),m(h,null,A(e.menu.children,o=>{var f;return d(),m(h,{key:o.path??JSON.stringify(o)},[((f=o.meta)==null?void 0:f.menu)!==!1?(d(),g(s,{key:0,"unique-key":[...e.uniqueKey,o.path??JSON.stringify(o)],menu:o,level:e.level+1},null,8,["unique-key","menu","level"])):y("",!0)],64)}),128))]),_:1},8,["mask","class"])):y("",!0)]),_:1},16)],8,["disabled"])):y("",!0)],64)}}});export{Q as _};
//# sourceMappingURL=sub.vue_vue_type_script_setup_true_lang-BAaA2YAV.js.map
